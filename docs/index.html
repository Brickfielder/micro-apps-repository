<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Micro Apps Ã¢â‚¬â€ Gallery</title>

  <!-- Shared theme (relative to docs/) -->
  <link rel="stylesheet" href="shared/theme.css" />

  <style>
    .gallery-wrap{max-width:1100px;margin:0 auto;padding:24px 20px 56px;}
    .gallery-hero{background:var(--surface);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow);padding:18px;margin:8px 0 20px;}
    .gallery-hero h1{font-size:clamp(1.6rem,2.5vw,2.2rem);margin:0 0 6px;}
    .gallery-hero p{margin:0;color:var(--muted);font-size:var(--size-lead);}
    .controls{display:flex;gap:10px;margin:16px 0;}
    .controls input[type="search"]{flex:1;padding:10px 12px;border:1px solid var(--line);border-radius:10px;font:inherit}
    .cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px;}
    .card{background:var(--surface);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow);padding:16px;text-decoration:none;color:inherit;display:flex;flex-direction:column;transition:transform .06s ease, box-shadow .12s ease;min-height:160px}
    .card:hover{transform:translateY(-1px)}
    .card h3{margin:0 0 6px;font-size:1.1rem;display:flex;align-items:center;gap:.5rem}
    .card p{margin:0;color:var(--muted);font-size:.95rem}
    .empty{color:var(--muted);padding:16px;border:1px dashed var(--line);border-radius:12px;text-align:center}
    .emoji{font-size:1.25rem;line-height:1}
  </style>
</head>
<body>
  <div class="gallery-wrap">
    <header class="gallery-hero" aria-describedby="subtitle">
      <h1>Micro Apps</h1>
      <p id="subtitle">Consistent header, fonts, and clinician comments across apps.</p>
      <div class="controls">
        <input id="q" type="search" placeholder="Filter apps by name or descriptionÃ¢â‚¬Â¦" aria-label="Filter apps" />
      </div>
    </header>

    <section class="cards" id="cards" aria-live="polite"></section>
    <div id="empty" class="empty" hidden>No matches. Try a different search.</div>
  </div>

  <script>
    const cardsEl = document.getElementById('cards');
    const emptyEl = document.getElementById('empty');
    const searchEl = document.getElementById('q');

    /** Render a single card */
    function cardTpl(item){
      const emoji = item.emoji ? `<span class="emoji" aria-hidden="true">${item.emoji}</span>` : '';
      const title = item.title || item.slug;
      const desc  = item.description || '';
      return `
        <a class="card" href="apps/${item.slug}/" aria-label="${title}">
          <h3>${emoji}<span>${title}</span></h3>
          <p>${desc}</p>
        </a>
      `;
    }

    /** Render list with optional filter */
    function render(list, q=''){
      const norm = q.trim().toLowerCase();
      const filtered = !norm ? list : list.filter(i =>
        (i.title||'').toLowerCase().includes(norm) ||
        (i.description||'').toLowerCase().includes(norm) ||
        (i.slug||'').toLowerCase().includes(norm)
      );
      cardsEl.innerHTML = filtered.map(cardTpl).join('');
      emptyEl.hidden = filtered.length !== 0;
    }

    /** Load catalog and init */
    fetch('catalog.json')
      .then(r => r.json())
      .then(items => {
        // basic sanity: require slug
        const clean = items.filter(i => i && i.slug);
        render(clean);
        searchEl.addEventListener('input', () => render(clean, searchEl.value));
      })
      .catch(err => {
        cardsEl.innerHTML = `<div class="empty">Could not load catalog.json</div>`;
        console.warn('Catalog load failed', err);
      });
  </script>
</body>
</html>
