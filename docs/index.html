<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Cognitive Rehabilitation Micro-Apps</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f9fafb; --surface:#fff; --surface-alt:#f8f9fc; --text:#1f2937; --muted:#6b7280; --line:#e5e7eb;
    --accent:#ff7a6e; --accent-dark:#f05245; --pill:#f2f4f7; --radius:16px;
    --shadow:0 2px 6px rgba(0,0,0,.08); --shadow-hover:0 22px 44px rgba(15,23,42,.18);
    --header-h:84px; --maxw:1200px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%}
  body{
    font-family:"Inter", system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    color:var(--text); background:var(--bg); position:relative;
    display:flex; flex-direction:column; min-height:100vh;
    letter-spacing:-0.01em;
  }

  .sr-only{
    position:absolute;
    width:1px;
    height:1px;
    padding:0;
    margin:-1px;
    overflow:hidden;
    clip:rect(0,0,0,0);
    white-space:nowrap;
    border:0;
  }

  /* Particle canvas behind everything */
  #tsparticles { position: fixed; inset: 0; z-index: -1; }

  /* Header */
  header{
    background:linear-gradient(135deg, rgba(255,255,255,0.92) 10%, rgba(255,245,243,0.9) 90%);
  }
  .nav-shell{
    position:sticky; top:0; z-index:20;
    background:linear-gradient(135deg, rgba(255,255,255,0.96) 10%, rgba(255,245,243,0.94) 90%);
    box-shadow:0 2px 14px rgba(15,23,42,.06);
    border-bottom:1px solid rgba(255,255,255,0.6);
    backdrop-filter:blur(16px);
  }
  .header-inner{
    max-width:var(--maxw);
    margin:0 auto;
    padding:2.6rem 1.25rem 3rem;
    display:flex;
    flex-direction:column;
    gap:1.75rem;
  }
  .topbar{
    max-width:var(--maxw);
    margin:0 auto;
    padding:1.2rem 1.25rem;
    display:flex;
    align-items:center;
    gap:1rem;
    font-size:0.95rem;
    color:var(--muted);
  }
  .brand{display:flex;align-items:center;gap:.75rem;font-weight:700;color:var(--text);letter-spacing:-0.02em;font-size:1rem}
  .brand .badge{display:inline-flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:12px;background:linear-gradient(150deg,var(--accent)0%,var(--accent-dark)90%);color:#fff;font-size:1.35rem;box-shadow:0 12px 24px rgba(240,82,69,.35)}
  .top-links{display:flex;align-items:center;gap:.75rem;margin-left:auto}
  .top-links a{color:inherit;text-decoration:none;padding:.35rem .6rem;border-radius:999px;border:1px solid transparent;transition:.2s}
  .top-links a:hover{border-color:rgba(15,23,42,.08);color:var(--text);background:rgba(255,255,255,0.7)}
  .cta-pill{background:var(--text);color:#fff !important;font-weight:600}

  .hero{display:grid;grid-template-columns:minmax(0,1fr);gap:2.4rem;align-items:center}
  .hero-copy{display:flex;flex-direction:column;gap:1.2rem}
  .hero-eyebrow{font-size:.9rem;font-weight:600;text-transform:uppercase;letter-spacing:.18em;color:var(--accent-dark)}
  .hero h1{margin:0;font-size:clamp(2.4rem, 3vw + 1.8rem, 3.3rem);font-weight:800;line-height:1.05;color:#101828}
  .hero p{margin:0;font-size:1.05rem;line-height:1.6;color:color-mix(in oklab,var(--text),white 25%)}
  .hero-actions{display:flex;flex-wrap:wrap;gap:.75rem;margin-top:.5rem}
  .btn{display:inline-flex;align-items:center;gap:.5rem;padding:.7rem 1.3rem;border-radius:999px;font-weight:600;text-decoration:none;border:1px solid transparent;transition:.2s;font-size:.95rem;cursor:pointer}
  .btn.primary{background:linear-gradient(140deg,var(--accent)0%,var(--accent-dark)92%);color:#fff;box-shadow:0 20px 30px rgba(240,82,69,.25)}
  .btn.primary:hover{transform:translateY(-1px);box-shadow:0 24px 40px rgba(240,82,69,.28)}
  .btn.secondary{background:rgba(255,255,255,0.75);border-color:rgba(15,23,42,.08);color:var(--text)}
  .btn.secondary:hover{background:#fff;border-color:rgba(15,23,42,.15)}
  .hero-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:.85rem;margin-top:.25rem}
  .hero-stats .stat{padding:.85rem 1rem;border-radius:var(--radius);background:rgba(255,255,255,0.78);border:1px solid rgba(15,23,42,.05);box-shadow:0 8px 20px rgba(15,23,42,.08)}
  .hero-stats dt{margin:0;font-weight:700;font-size:1.6rem;color:#0f172a}
  .hero-stats dd{margin:.15rem 0 0;font-size:.85rem;color:var(--muted)}
  @media(max-width:720px){
    .topbar{flex-direction:column;align-items:flex-start;gap:.5rem;padding:1rem 1.1rem}
    .top-links{width:100%;justify-content:flex-start;flex-wrap:wrap}
    .hero{gap:2rem}
  }

  /* Layout */
  main{ flex:1; max-width:var(--maxw); margin:1.5rem auto 3rem; padding:0 1rem; }

  .hero{
    background:linear-gradient(135deg,rgba(255,255,255,0.92) 0%,rgba(255,240,236,0.88) 40%,rgba(240,247,255,0.9) 100%);
    border:1px solid rgba(255,255,255,0.6);
    border-radius:calc(var(--radius) + 12px);
    padding:3.2rem clamp(1.5rem, 5vw, 3rem);
    position:relative;
    overflow:hidden;
    box-shadow:0 40px 80px rgba(15,23,42,0.08);
    margin-bottom:2.5rem;
  }
  .hero::after{
    content:""; position:absolute; inset:auto -25% -40% auto;
    width:420px; height:420px;
    background:radial-gradient(circle,#ffe2db 0%,rgba(255,255,255,0) 70%);
    opacity:.7; pointer-events:none;
  }
  .hero-content{position:relative; z-index:1; max-width:620px;}
  .hero h2{margin:0 0 1.2rem; font-size:clamp(2.3rem, 4vw, 3.1rem); line-height:1.1; letter-spacing:-0.02em;}
  .hero p{margin:0 0 1.6rem; font-size:1.1rem; line-height:1.65; color:#334155;}
  .hero-actions{display:flex; gap:.75rem; flex-wrap:wrap;}
  .cta-btn{
    background:var(--accent); color:#fff; font-weight:600; font-size:1rem;
    border:none; border-radius:999px; padding:.75rem 1.5rem;
    box-shadow:0 18px 30px rgba(255,122,110,0.35); cursor:pointer; transition:.2s ease;
  }
  .cta-btn:hover{transform:translateY(-2px); background:#ff6b5d;}
  .ghost-btn{
    background:rgba(255,255,255,0.6); border:1px solid rgba(148,163,184,0.45);
    color:#0f172a; font-weight:600; border-radius:999px; padding:.75rem 1.35rem;
    backdrop-filter:blur(8px); cursor:pointer; transition:.2s ease;
  }
  .ghost-btn:hover{background:rgba(255,255,255,0.85);}

  /* Sections */
  .section{
    margin-bottom:3rem;
  }

  .section-header{
    display:flex;
    flex-wrap:wrap;
    justify-content:space-between;
    gap:1.5rem;
    align-items:flex-end;
    margin-bottom:1.75rem;
  }

  .section-titles{max-width:620px;display:flex;flex-direction:column;gap:.65rem;}
  .section-eyebrow{font-size:.8rem;font-weight:600;letter-spacing:.16em;text-transform:uppercase;color:var(--accent-dark);}
  .section-header h2{margin:0;font-size:clamp(1.9rem,3vw,2.4rem);line-height:1.15;color:#101828;}
  .section-lede{margin:0;font-size:1rem;line-height:1.6;color:#475569;}

  .filter-search{position:relative;min-width:240px;}
  .filter-search input{
    width:100%;
    border-radius:999px;
    border:1px solid rgba(148,163,184,0.45);
    background:rgba(255,255,255,0.75);
    padding:.65rem 1.1rem .65rem 2.7rem;
    font-size:.95rem;
    color:var(--text);
    box-shadow:0 10px 18px rgba(15,23,42,.05);
    transition:border .2s, box-shadow .2s, background .2s;
  }
  .filter-search input:focus{
    outline:none;
    border-color:var(--accent);
    box-shadow:0 12px 24px rgba(255,122,110,0.25);
    background:#fff;
  }
  .filter-search svg{
    position:absolute;
    left:.95rem;
    top:50%;
    transform:translateY(-50%);
    width:18px;height:18px;
    color:var(--muted);
    pointer-events:none;
  }

  .tag-cloud{display:flex;flex-wrap:wrap;gap:.55rem;margin-bottom:1.75rem;}
  .tag-pill{
    border:none;
    display:inline-flex;
    align-items:center;
    gap:.35rem;
    padding:.45rem .95rem;
    border-radius:999px;
    background:rgba(148,163,184,0.14);
    color:#334155;
    font-size:.85rem;
    font-weight:600;
    cursor:pointer;
    transition:background .2s,color .2s,transform .2s,box-shadow .2s;
  }
  .tag-pill:focus-visible{outline:2px solid var(--accent);outline-offset:2px;}
  .tag-pill:hover{background:rgba(148,163,184,0.22);transform:translateY(-1px);}
  .tag-pill[data-active="true"]{
    background:linear-gradient(150deg,rgba(255,122,110,0.12)0%,rgba(240,82,69,0.18)100%);
    color:var(--accent-dark);
    box-shadow:0 10px 20px rgba(240,82,69,0.16);
  }

  .apps-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1.4rem;}
  .card{
    background:rgba(255,255,255,0.92);
    border-radius:calc(var(--radius) + 6px);
    padding:1.4rem 1.5rem 1.6rem;
    border:1px solid rgba(148,163,184,0.18);
    box-shadow:0 22px 38px rgba(15,23,42,0.08);
    transition:transform .22s cubic-bezier(.16,1,.3,1), box-shadow .22s;
    position:relative;
    overflow:hidden;
  }
  .card::after{
    content:"";
    position:absolute;
    inset:auto -35% -60% auto;
    width:220px;height:220px;
    background:radial-gradient(circle,rgba(255,245,243,0.9) 0%,rgba(255,255,255,0) 70%);
    opacity:0;
    transition:opacity .3s;
  }
  .card:hover{transform:translateY(-6px);box-shadow:var(--shadow-hover);}
  .card:hover::after{opacity:1;}
  .card a{color:inherit;text-decoration:none;display:block;height:100%;}
  .card-emoji{font-size:2rem;margin-bottom:1rem;}
  .card h3{margin:0;font-size:1.15rem;letter-spacing:-0.01em;color:#0f172a;}
  .card p{margin:.7rem 0 1.1rem;font-size:.95rem;line-height:1.55;color:#475569;}
  .tag-list{display:flex;flex-wrap:wrap;gap:.4rem;}
  .tag-list span{display:inline-flex;align-items:center;padding:.35rem .7rem;font-size:.75rem;border-radius:999px;background:var(--pill);color:#475569;font-weight:600;}

  .empty-state{
    padding:2.5rem;
    border-radius:var(--radius);
    border:1px dashed rgba(148,163,184,0.4);
    text-align:center;
    color:#475569;
    background:rgba(248,250,252,0.75);
    font-size:1rem;
  }

  .featured-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.4rem;}
  .featured-card{
    background:linear-gradient(140deg,rgba(255,255,255,0.95)0%,rgba(255,240,236,0.9)100%);
    border:1px solid rgba(255,205,196,0.6);
    box-shadow:0 24px 40px rgba(240,82,69,0.18);
  }
  .featured-card h3{display:flex;align-items:center;gap:.5rem;}
  .featured-card h3::after{
    content:"Featured";
    font-size:.7rem;
    letter-spacing:.12em;
    text-transform:uppercase;
    background:rgba(240,82,69,0.16);
    color:var(--accent-dark);
    padding:.2rem .55rem;
    border-radius:999px;
  }

  /* Footer */
  .site-footer{
    background:linear-gradient(180deg,rgba(255,255,255,0.85) 0%,rgba(241,245,249,0.95) 100%);
    border-top: 1px solid rgba(226,232,240,0.9);
    padding: 2rem 1.25rem 2.5rem;
    text-align: center;
    font-size: 0.95rem;
    color: var(--muted);
  }
  .site-footer a{ color: var(--accent); text-decoration: none; }
  .site-footer a:hover{ text-decoration: underline; }

  @media(max-width:720px){
    .header-inner{flex-direction:column; align-items:flex-start; text-align:left;}
    .nav-actions{width:100%; justify-content:flex-start;}
    .hero{padding:2.4rem 1.4rem;}
    .card{min-height:210px;}
    .section-header{flex-direction:column;align-items:flex-start;}
    .filter-search{width:100%;}
    .filter-search input{width:100%;}
  }
</style>
</head>
<body>
<!-- Particle background -->
<div id="tsparticles"></div>

<header>
  <div class="nav-shell">
    <div class="topbar">
      <span class="brand"><span class="badge">µ</span> Cognitive Rehab Lab</span>
      <nav class="top-links" aria-label="Primary">
        <a href="#grid">Browse library</a>
        <a href="https://github.com/marcomion/micro-apps" target="_blank" rel="noopener">GitHub</a>
        <a class="cta-pill" href="mailto:m.mion@nhs.net">Partner with us</a>
      </nav>
    </div>
  </div>

  <div class="header-inner">
    <div class="hero">
      <div class="hero-copy">
        <span class="hero-eyebrow">Cognitive rehabilitation micro-experiences</span>
        <h1>Beautifully crafted clinical tools you can try in minutes.</h1>
        <p>
          Explore an evolving lab of lightweight, evidence-aligned applications that support assessment,
          therapy practice, and research collaboration for clinicians and scientists.
        </p>
        <div class="hero-actions">
          <a class="btn primary" href="#grid">Browse the collection</a>
          <a class="btn secondary" href="mailto:m.mion@nhs.net">Discuss a project</a>
        </div>
        <dl class="hero-stats" aria-live="polite">
          <div class="stat">
            <dt id="statApps">0</dt>
            <dd>Micro-apps available</dd>
          </div>
          <div class="stat">
            <dt id="statTags">0</dt>
            <dd>Clinical focus areas</dd>
          </div>
          <div class="stat">
            <dt id="statFeatured">0</dt>
            <dd>Curated editor’s picks</dd>
          </div>
        </dl>
      </div>
    </div>
  </div>
</header>

<main>
  <section class="section" id="grid">
    <header class="section-header">
      <div class="section-titles">
        <span class="section-eyebrow">Micro-app library</span>
        <h2>Explore focused experiences for cognitive rehabilitation</h2>
        <p class="section-lede">Search by need, or skim the featured highlights curated by our clinical team.</p>
      </div>
      <label class="filter-search">
        <span class="sr-only">Search micro-apps</span>
        <svg aria-hidden="true" viewBox="0 0 24 24" fill="none"><path d="m21 21-4.8-4.8m2.3-5.5a7.8 7.8 0 1 1-15.6 0 7.8 7.8 0 0 1 15.6 0Z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/></svg>
        <input type="search" id="search" placeholder="Search by name or description" autocomplete="off" spellcheck="false">
      </label>
    </header>

    <div class="tag-cloud" id="tagCloud" aria-live="polite"></div>

    <div class="apps-grid" id="appGrid" aria-live="polite"></div>
    <div class="empty-state" id="emptyState" hidden>No micro-apps match your filters just yet. Clear filters to browse the full collection.</div>
  </section>

  <section class="section" id="featured">
    <header class="section-header">
      <div class="section-titles">
        <span class="section-eyebrow">Editor’s picks</span>
        <h2>Start with popular experiences that spark engagement</h2>
        <p class="section-lede">A rotating set of featured micro-apps that clinicians rate highly for their impact and clarity.</p>
      </div>
    </header>
    <div class="featured-grid" id="featuredGrid" aria-live="polite"></div>
  </section>
</main>

<footer class="site-footer">
  <p>
    © 2025 Cognitive Rehabilitation Micro-Apps — Licensed under the 
    <a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener">Apache 2.0 License</a>.
  </p>
  <p>
    Contact: <a href="mailto:m.mion@nhs.net">m.mion@nhs.net</a> · 
    <a href="https://www.linkedin.com/in/marco-mion/" target="_blank" rel="noopener">LinkedIn</a>
  </p>
  <p id="last-updated" class="muted"></p>
</footer>

<!-- tsParticles -->
<script src="https://cdn.jsdelivr.net/npm/tsparticles@2/tsparticles.bundle.min.js"></script>
<script>
  const state = {
    apps: [],
    activeTag: 'all',
    search: ''
  };

  // ==== Particles ====
  tsParticles.load("tsparticles", {
    background: { color: "#f9fafb" },
    particles: {
      number: { value: 60, density: { enable: true, value_area: 800 } },
      color: { value: "#94a3b8" }, shape: { type: "circle" }, opacity: { value: 0.5 }, size: { value: 2 },
      line_linked: { enable: true, distance: 120, color: "#cbd5e1", opacity: 0.4, width: 1 },
      move: { enable: true, speed: 1.2, outModes: { default: "bounce" } }
    },
    interactivity: { events: { onhover: { enable: true, mode: "grab" }, resize: true },
      modes: { grab: { distance: 140, line_linked: { opacity: 0.7 } } } },
    retina_detect: true
  });

  // ==== Footer: last updated ====
  (function(){
    const stamp = new Date(document.lastModified);
    const lu = document.getElementById("last-updated");
    if (lu) {
      lu.textContent = "Last updated: " + stamp.toLocaleDateString(undefined, {
        year: "numeric", month: "long", day: "numeric"
      });
    }
  })();

  // ==== Catalog rendering ====
  const appGrid = document.getElementById('appGrid');
  const featuredGrid = document.getElementById('featuredGrid');
  const tagCloud = document.getElementById('tagCloud');
  const searchInput = document.getElementById('search');
  const emptyState = document.getElementById('emptyState');

  function createTagPill(tag, count) {
    const pill = document.createElement('button');
    pill.className = 'tag-pill';
    pill.type = 'button';
    pill.dataset.tag = tag;
    pill.setAttribute('data-active', tag === state.activeTag ? 'true' : 'false');
    pill.textContent = tag === 'all' ? `All (${state.apps.length})` : `${tag} (${count})`;
    pill.addEventListener('click', () => {
      state.activeTag = tag === state.activeTag ? 'all' : tag;
      renderTagCloud();
      renderApps();
    });
    return pill;
  }

  function renderTagCloud() {
    tagCloud.innerHTML = '';
    const counts = {};
    state.apps.forEach(app => {
      (app.tags || []).forEach(tag => {
        counts[tag] = (counts[tag] || 0) + 1;
      });
    });
    const sortedTags = Object.keys(counts).sort((a,b) => counts[b] - counts[a] || a.localeCompare(b));
    const fragment = document.createDocumentFragment();
    fragment.appendChild(createTagPill('all'));
    sortedTags.forEach(tag => fragment.appendChild(createTagPill(tag, counts[tag])));
    tagCloud.appendChild(fragment);
  }

  function renderApps() {
    if (!appGrid) return;
    appGrid.innerHTML = '';
    const filtered = state.apps.filter(app => {
      const matchesTag = state.activeTag === 'all' || (app.tags || []).includes(state.activeTag);
      const term = state.search.trim().toLowerCase();
      const matchesSearch = !term || [app.title, app.description, (app.tags || []).join(' ')].some(text => (text || '').toLowerCase().includes(term));
      return matchesTag && matchesSearch;
    });

    if (filtered.length === 0) {
      emptyState.hidden = false;
      return;
    }

    emptyState.hidden = true;
    const fragment = document.createDocumentFragment();
    filtered.forEach(app => {
      const card = document.createElement('article');
      card.className = `card${app.featured ? ' featured-card' : ''}`;
      const url = `apps/${app.slug}/`;
      card.innerHTML = `
        <a href="${url}">
          <div class="card-emoji" aria-hidden="true">${app.emoji || '✨'}</div>
          <h3>${app.title}</h3>
          <p>${app.description}</p>
          <div class="tag-list">
            ${(app.tags || []).map(tag => `<span>${tag}</span>`).join('')}
          </div>
        </a>
      `;
      fragment.appendChild(card);
    });
    appGrid.appendChild(fragment);
  }

  function renderFeatured() {
    if (!featuredGrid) return;
    featuredGrid.innerHTML = '';
    const featuredApps = state.apps.filter(app => app.featured);
    if (featuredApps.length === 0) {
      featuredGrid.innerHTML = '<p class="empty-state">Mark an app as featured in <code>catalog.json</code> to highlight it here.</p>';
      return;
    }
    const fragment = document.createDocumentFragment();
    featuredApps.forEach(app => {
      const card = document.createElement('article');
      card.className = 'card featured-card';
      card.innerHTML = `
        <a href="apps/${app.slug}/">
          <div class="card-emoji" aria-hidden="true">${app.emoji || '⭐️'}</div>
          <h3>${app.title}</h3>
          <p>${app.description}</p>
          <div class="tag-list">
            ${(app.tags || []).map(tag => `<span>${tag}</span>`).join('')}
          </div>
        </a>
      `;
      fragment.appendChild(card);
    });
    featuredGrid.appendChild(fragment);
  }

  function updateStats() {
    const totalApps = state.apps.length;
    const allTags = new Set();
    let featuredCount = 0;
    state.apps.forEach(app => {
      (app.tags || []).forEach(tag => allTags.add(tag));
      if (app.featured) featuredCount += 1;
    });
    const statApps = document.getElementById('statApps');
    const statTags = document.getElementById('statTags');
    const statFeatured = document.getElementById('statFeatured');
    if (statApps) statApps.textContent = totalApps;
    if (statTags) statTags.textContent = allTags.size;
    if (statFeatured) statFeatured.textContent = featuredCount;
  }

  async function loadCatalog() {
    try {
      const response = await fetch('catalog.json', { cache: 'no-store' });
      if (!response.ok) throw new Error('Unable to load catalog');
      const data = await response.json();
      state.apps = (Array.isArray(data) ? data : []).sort((a,b) => a.title.localeCompare(b.title));
      updateStats();
      renderTagCloud();
      renderApps();
      renderFeatured();
    } catch (error) {
      console.error(error);
      emptyState.hidden = false;
      emptyState.textContent = 'We could not load the catalog right now. Please refresh the page to try again.';
    }
  }

  if (searchInput) {
    searchInput.addEventListener('input', (event) => {
      state.search = event.target.value;
      renderApps();
    });
  }

  loadCatalog();
</script>
</body>
</html>
